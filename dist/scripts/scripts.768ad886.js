"use strict";angular.module("address book",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("address book").controller("MainCtrl",["$scope","Backend",function(a,b){a.init=function(){var c=this,d=localStorage.addressBook;"undefined"==typeof d?b.loadRecords().then(function(a){a.data&&(localStorage.addressBook=JSON.stringify(a.data),c.data=a.data,c.filterRecords())}):(a.data=JSON.parse(d),a.filterRecords())},a.filterRecords=function(){var b,c=a.filters;b=a.data.map(function(a,b){return a.id=b,a}),Object.keys(c).forEach(function(a){c[a]&&(b=b.filter(function(b){return b[a].indexOf(c[a])>-1}))}),a.filtered=b},a.updateRecord=function(c){var d;"undefined"==typeof c?(c=a.data.length,d=a.newRecord,a.newRecord={}):d=a.filtered[c],a.data[c]=d,b.updateRecord(c,d),a.filterRecords()},a.deleteRecord=function(c){var c;"undefined"!=typeof c&&(a.data.splice(c,1),b.deleteRecord(c),a.filterRecords())},a.filters={name:"",phone:"",address:""},a.init()}]),angular.module("address book").controller("AboutCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("address book").service("Backend",["$http",function(a){this.url="",this.loadRecords=function(){return a({method:"GET",url:"data/data.json"})},this.updateRecord=function(b,c){var d=JSON.parse(localStorage.addressBook);return delete c.id,delete c.$$hashKey,d[b]=c,localStorage.addressBook=JSON.stringify(d),a({method:"POST",data:{id:b,data:c},url:this.url})},this.deleteRecord=function(b){var c=JSON.parse(localStorage.addressBook);return c.splice(b,1),localStorage.addressBook=JSON.stringify(c),a({method:"POST",data:{id:b},url:this.url})}}]);