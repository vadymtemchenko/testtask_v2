"use strict";angular.module("addressBook",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("addressBook").filter("filterAddress",[function(){return function(a,b){var c;return a=a||[],c=a.map(function(a,b){return a.id=b,a}),Object.keys(b).forEach(function(a){b[a]&&(c=c.filter(function(c){return c[a].toLowerCase().indexOf(b[a].toLowerCase())>-1}))}),c}}]),angular.module("addressBook").controller("MainCtrl",["$scope","Backend",function(a,b){a.init=function(){var c=this,d=localStorage.addressBook;"undefined"==typeof d?b.loadRecords().then(function(a){a.data&&(localStorage.addressBook=JSON.stringify(a.data),c.data=a.data)}):a.data=JSON.parse(d)},a.updateRecord=function(c){"undefined"==typeof c&&(c=a.data.length,a.data[c]=a.newRecord,a.newRecord={}),b.updateRecord(c,a.data[c])},a.deleteRecord=function(c){"undefined"!=typeof c&&(a.data.splice(c,1),b.deleteRecord(c))},a.filters={name:"",phone:"",address:""},a.init()}]),angular.module("addressBook").service("Backend",["$http",function(a){this.url="",this.loadRecords=function(){return a({method:"GET",url:"data/data.json"})},this.updateRecord=function(b,c){var d=JSON.parse(localStorage.addressBook);return delete c.id,delete c.$$hashKey,d[b]=c,localStorage.addressBook=JSON.stringify(d),a({method:"POST",data:{id:b,data:c},url:this.url})},this.deleteRecord=function(b){var c=JSON.parse(localStorage.addressBook);return c.splice(b,1),localStorage.addressBook=JSON.stringify(c),a({method:"POST",data:{id:b},url:this.url})}}]);